<!doctype html><html lang=en-us><head><title>Cache busting in ASP.NET Core</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Caching static resources is a good way to improve the performance of your website. Instead of your server having to deliver each static resource on every request. The user's browser caches the static resources the first time that they're requested and received, and thereafter loads them from the cache on the following requests instead of requesting them from the server again."><meta property="article:published_time" content="17-07-2017 00:00:00"><link async href="https://fonts.googleapis.com/css2?family=Jura:wght@300;400;500;600;700&display=swap" rel=stylesheet><link async rel=stylesheet href=/css/main.css type=text/css><link async rel=icon href=/favicon.ico><script async src=https://kit.fontawesome.com/0d71694d01.js crossorigin=anonymous></script></head><body><div class=grid-container><header class=header><div class=header-collection><div class=header-item><a class=header-item__link href=/><h1 class=header-item__title>Homepage | Rune Nielsen</h1></a></div></div><div class=header-collection><div class=header-item><a class=header-item__link target=_blank href=https://github.com/runeanielsen><p class=header-item__icon><i class="fab fa-github-square"></i></p></a></div><div class=header-item><a class=header-item__link target=_blank href=https://linkedin.com/in/runeanielsen><p class=header-item__icon><i class="fab fa-linkedin"></i></p></a></div></div></header><div class=blog-post><h1 class=blog-post__title>Cache busting in ASP.NET Core</h1><p class=blog-post__date>Mon, Jul 17, 2017</p><article class=blog-post__content><p>Caching static resources is a good way to improve the performance of your website. Instead of your server having to deliver each static resource on every request. The user&rsquo;s browser caches the static resources the first time that they&rsquo;re requested and received, and thereafter loads them from the cache on the following requests instead of requesting them from the server again. <em>To implement static resource caching in ASP.NET Core you can read this blog post <a href=/post/response-caching-in-asp-net-core title="Response caching in ASP.NET Core">link</a>.</em></p><p>The problem with caching static resources is that the user might have cached resources that don&rsquo;t match the files on the server. The caching might not be a big concern when dealing with images but can result in unexpected results when it comes to JavaScript and CSS files. To handle the issue we will have to ensure that the client is always having the latest version of our static files. To do that we will introduce the concept of <strong>versioned URLs</strong>.</p><h2 id=versioned-url>Versioned URL</h2><p>Versioning a URL is the process of giving a file a unique URL every time the file changes. Giving the file a unique URL prevents the browser from loading the previous version from the cache because it will only load the files from the cache if they match the same URL, that the resource was first requested from.</p><p>Three possible strategies are as follows.</p><ul><li>Query string: <strong><a href="http://mywebsite.io/file.js?v=123">http://mywebsite.io/file.js?v=123</a></strong></li><li>Unique file name: <strong><a href=http://mywebsite.io/file-v2.js>http://mywebsite.io/file-v2.js</a></strong></li><li>New folder for every version: <strong><a href=http://mywebsite.io/version-2/file.js>http://mywebsite.io/version-2/file.js</a></strong></li></ul><p>All of the above strategies can be achieved if you&rsquo;re using a task runner like <a href=http://gulpjs.com/ title="Gulp website">Gulp</a> or a module-bundler like <a href=https://webpack.js.org/ title="Webpack website">Webpack</a>, but in this post, I will show you how to use the <strong>first</strong> strategy using ASP.NET Core <strong>tag helpers</strong>.</p><p>ASP.NET Core Razor view engine comes with a tag helper named &ldquo;<strong>asp-append-version</strong>". The tag helper is applied to the resource in the HTML file that should have a versioned URL, to make it work the value &ldquo;true&rdquo; should be set on the tag helper.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;~/lib.min.js&#34;</span> <span style=color:#a6e22e>asp-append-version</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;true&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div><p>By using the tag helper on the resource a randomly generated version number will be appended to the link as a query parameter. The version number generated is unique for every resource and will be generated again when the file changes.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/lib.min.js?v=Qx4RpgEaEqv4zROQBw9L_zUbUGd9QsLvaIfAsANsPxY&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</code></pre></div><p>That is actually everything there is to it. Every time you now update your static resource a new version is being appended to the URL and you will no longer have the problem with users having cached resources that do not match the resources being delivered from the server.</p></article></div></div></body></html>